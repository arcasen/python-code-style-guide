### 嵌套/局部/内部类和函数 

当用于闭包局部变量时，嵌套局部函数或类是可以的。内部类是可以的。

#### 定义 

可以在方法、函数或类内部定义类。可以在方法或函数内部定义函数。嵌套函数对封闭作用域中定义的变量具有只读访问权限[^nonlocal]。

[^nonlocal]: （译者注）这部分在 Python 中是基本正确的，但需要一些补充说明。在 Python 中，嵌套函数（nested functions）可以读取（read）定义在外部作用域（enclosing scope）中的变量，但默认情况下不能直接修改这些变量。如果需要修改外部作用域的变量，必须使用 nonlocal 关键字（Python 3 引入）来声明。

#### 优点 

允许定义仅在非常有限的作用域内使用的实用类和函数。非常 ADT[^adt] 风格。通常用于实现装饰器。

[^adt]: <https://en.wikipedia.org/wiki/Abstract_data_type>

#### 缺点 

嵌套函数和类无法直接测试。嵌套会使外部函数更长且可读性更差。

#### 决定 

可以使用，但有一些注意事项。除了闭包 `self` 或 `cls` 以外的局部值之外，避免嵌套函数或类。不要仅为了从模块用户隐藏而嵌套函数。相反，在模块级为其名称添加 `_` 前缀，以便测试仍能访问它。
